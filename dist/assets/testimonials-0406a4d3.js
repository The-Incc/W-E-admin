import{r as o,bS as O,j as e,S as l,a as P,T as B,B as d,l as H,aE as A,bT as E,bU as V,P as h,W as Y}from"./index-10cf8504.js";import{b as J}from"./format-time-f048003d.js";import{a as K,G as F}from"./format-number-c33a4dfd.js";import{C as Q}from"./Card-18804dcb.js";import{B as p}from"./Button-d54db9e7.js";import{L as X}from"./Link-cd35d975.js";import"./blog-01f831c2.js";import{C as Z}from"./Container-e053fb78.js";import{T as S}from"./TextField-d7688593.js";import"./Menu-91585512.js";const _={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4};function N({post:m,index:r}){const{name:u,createdAt:T}=m,n=r===0,i=r===1||r===2,[x,c]=o.useState(!1),[g,k]=o.useState(null),b=()=>{c(!1)},{token:f}=o.useContext(O),L=t=>{k(t),c(!0)},j=async()=>{try{c(!0);const t=await E.post(`/testimonial/deleteTestimonial/${g}`,{},{headers:{Authorization:`Bearer ${f}`}});console.log(t),b()}catch(t){console.error("Error deleting:",t)}},M=e.jsxs(e.Fragment,{children:[e.jsx(X,{color:"inherit",variant:"subtitle2",underline:"hover",sx:{height:44,overflow:"hidden",WebkitLineClamp:2,display:"-webkit-box",WebkitBoxOrient:"vertical",...n&&{typography:"h5",height:60},...(n||i)&&{color:"common.white"}},children:u}),e.jsx("button",{onClick:()=>L(m.id),children:"Delete"})]}),v=e.jsx(l,{direction:"row",flexWrap:"wrap",spacing:1.5,justifyContent:"flex-end",sx:{mt:3,color:"text.disabled"},children:[{number:0,icon:"eva:message-circle-fill"},{number:0,icon:"eva:eye-fill"},{number:0,icon:"eva:share-fill"}].map((t,w)=>e.jsxs(l,{direction:"row",sx:{...(n||i)&&{opacity:.48,color:"common.white"}},children:[e.jsx(P,{width:16,icon:t.icon,sx:{mr:.5}}),e.jsx(B,{variant:"caption",children:K(t.number)})]},w))}),D=e.jsx(d,{component:"img",src:"https://www.freepik.com/free-photos-vectors/white",sx:{top:0,width:1,height:1,objectFit:"cover",position:"absolute"}}),y=e.jsx(B,{variant:"caption",component:"div",sx:{mb:2,color:"text.disabled",...(n||i)&&{opacity:.48,color:"common.white"}},children:J(T)}),I=e.jsx(V,{color:"paper",src:"/assets/icons/shape-avatar.svg",sx:{width:80,height:36,zIndex:9,bottom:-15,position:"absolute",color:"background.paper",...(n||i)&&{display:"none"}}});return e.jsxs(e.Fragment,{children:[e.jsx(F,{xs:12,sm:n?12:6,md:n?6:3,children:e.jsxs(Q,{children:[e.jsxs(d,{sx:{position:"relative",pt:"calc(100% * 3 / 4)",...(n||i)&&{pt:"calc(100% * 4 / 3)","&:after":{top:0,content:"''",width:"100%",height:"100%",position:"absolute",bgcolor:t=>H(t.palette.grey[900],.72)}},...n&&{pt:{xs:"calc(100% * 4 / 3)",sm:"calc(100% * 3 / 4.66)"}}},children:[I,D]}),e.jsxs(d,{sx:{p:t=>t.spacing(4,3,3,3),...(n||i)&&{width:1,bottom:0,position:"absolute"}},children:[y,M,v]})]})}),e.jsx(A,{open:x,onClose:b,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(d,{borderRadius:3,sx:_,children:[e.jsx(l,{spacing:2,width:800}),e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this testimonial?"}),e.jsx(p,{variant:"contained",color:"error",sx:{width:"150px",alignSelf:"center"},onClick:j,children:"Yes"}),e.jsx(p,{variant:"contained",color:"inherit",sx:{width:"150px",alignSelf:"center",marginLeft:"20px"},mr:4,onClick:b,children:"No"})]})]})})]})}N.propTypes={post:h.object.isRequired,index:h.number};h.array,h.func;h.array.isRequired;function ee(){const[m,r]=o.useState(!1),[u,T]=o.useState(""),[n,i]=o.useState(""),[x,c]=o.useState(null),[g,k]=o.useState(""),[b,f]=o.useState(!1),[L,j]=o.useState(""),[M,v]=o.useState("success"),[D,y]=o.useState([]),{token:I}=o.useContext(O),t=()=>r(!0),w=()=>r(!1),R=s=>{T(s.target.value)},W=s=>{i(s.target.value)},$=s=>{k(s.target.value)},z=s=>{c(s.target.files[0])},U=async s=>{s.preventDefault();const a=new FormData;a.append("name",n),a.append("description",u),a.append("location",g),x&&a.append("file",x);try{const C=await E.post("/testimonial/add-testimonial",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${I}`}});if(C.status===201){w(),v("success"),j("Testimonial added successfully!"),f(!0);const q=C.data.testimonial;y(G=>[...G,q])}}catch(C){console.error("Error adding Testimonial:",C),v("error"),j("Error adding Testimonial. Please try again."),f(!0)}};return o.useEffect(()=>{(async()=>{try{const a=await E.get("/testimonial/get-all-testimonials");console.log(a.data.testimonials),y(a.data.testimonials)}catch(a){console.log("Error fetching testimonials",a)}})()},[]),e.jsxs(Z,{children:[e.jsxs(l,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(B,{variant:"h4",children:"Testmonials"}),e.jsx(p,{variant:"contained",color:"inherit",onClick:t,startIcon:e.jsx(P,{icon:"eva:plus-fill"}),children:"Add Testimonial"}),e.jsx(A,{open:m,onClose:w,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(d,{sx:te,borderRadius:3,children:e.jsxs(l,{spacing:2,mt:2,width:800,children:[e.jsx(S,{id:"outlined-basic",label:"Heading",variant:"outlined"}),e.jsx(S,{label:"Name",variant:"outlined",value:n,onChange:W}),e.jsx(S,{label:"Description",variant:"outlined",value:u,onChange:R}),e.jsx(S,{label:"Location",variant:"outlined",value:g,onChange:$}),e.jsxs(p,{variant:"contained",component:"label",color:"inherit",sx:{width:"150px",alignSelf:"center"},children:["Upload Image",e.jsx("input",{type:"file",hidden:!0,onChange:z})]}),e.jsx(p,{variant:"contained",color:"inherit",sx:{width:"150px",alignSelf:"center"},onClick:U,children:"Save"})]})})})]}),e.jsx(l,{mb:5,direction:"row",alignItems:"center",justifyContent:"space-between"}),e.jsx(F,{container:!0,spacing:3,children:D.map((s,a)=>e.jsx(N,{post:s,index:a},s.id))})]})}const te={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,p:4};function he(){return e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:e.jsx("title",{children:" Testimonial | Minimal UI "})}),e.jsx(ee,{})]})}export{he as default};
